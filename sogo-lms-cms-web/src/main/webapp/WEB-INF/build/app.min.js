var app=angular.module("app","ui.router ngSanitize angular-cache ngProgress ui.select ui-notification ui.tinymce".split(" "));app.value("genderArray",["Unknown","Male","Female"]);
app.run(["$rootScope","$q","$state","$urlRouter","$timeout","notifyService","CacheFactory","progressService","$transitions","sharedService","$trace",function(b,d,a,g,h,e,f,c,l,k,m){b.pageLoaded=!1;b.appName="LMS";b.SERVER_DATE_FORMAT="YYYY-MM-DD";b.FULL_CALENDAR_DATE_TIME_FORMAT="YYYY-MM-DDTHH:mm:ss";b.currentYear=(new Date).getFullYear();b.currentDate=moment(new Date).format("DD/MM/YYYY");b.defaultPageSize=10;b.notifyService=e;b.sessionUserId=0;b.defaultPassword="1234567";b.noAvatarImgUrl="/images/no-avatar.jpg";
b.minSearchItem=5;b.isLoginPage=!1;b.isPanelFullScreenPage=!1;b.sessionInfo=[];m.enable("TRANSITION");b.tinymceOptions={plugins:"link image code autoresize table",menubar:"edit insert format table",statusbar:!1,baseURL:"/libs/tinymce",skin:"lightgray",theme:"modern",inline:!1,autoresize_min_height:200,autoresize_max_height:500,autoresize_bottom_margin:10,toolbar:"fontselect | fontsizeselect | undo redo | bold italic underline | alignleft aligncenter alignright | image | table | code",font_formats:"Arial\x3darial,helvetica,sans-serif;Courier New\x3dcourier new,courier,monospace,Times New Roman\x3dtimes new roman,times,serif;Proxima Nova\x3dProximaNova",
fontsize_formats:"8px 10px 12px 14px 16px 18px 20px 22px 24px 36px",image_title:!0,automatic_uploads:!0,images_upload_url:"Upload",images_upload_base_path:window.imageDomain,file_picker_types:"image",file_picker_callback:function(a,c,b){c=document.createElement("input");c.setAttribute("type","file");c.setAttribute("accept","image/*");c.onchange=function(){var c=this.files[0],b=new FileReader;b.onload=function(){var e="blobid"+(new Date).getTime(),n=tinymce.activeEditor.editorUpload.blobCache,f=b.result.split(",")[1],
e=n.create(e,c,f);n.add(e);a(e.blobUri(),{title:c.name})};b.readAsDataURL(c)};c.click()},setup:function(a){a.shortcuts.add("meta+s","save",function(){b.$broadcast("editorSave",a.getElement())})}};b.IsShowLoading=function(){return 0<c.status()&&100>c.status()};b.doLogout=function(){k.doLogout().then(function(){var c=encodeURIComponent(window.location.pathname+window.location.search);a.go("login",{ref:c})})};angular.element(document).on("click",function(a){b.$broadcast("documentClicked",angular.element(a.target))});
angular.element(document).on("keydown",function(c){27!=c.charCode&&27!=c.which&&27!=c.keyCode||!b.isPanelFullScreenPage||a.go(a.$current.parent,a.params,{reload:!1})});b.$on("updateSession",function(){});l.onSuccess({to:"login"},function(a){b.isLoginPage=!0});l.onSuccess({to:"root.error"},function(a){b.isErrorPage=!0});l.onSuccess({to:"root.**"},function(a){b.isLoginPage=!1;a.$to().data.isFullScreenPanel?b.isPanelFullScreenPage=!0:b.isPanelFullScreenPage=!1});l.onStart({},function(a){c.start()});
l.onSuccess({},function(a){c.complete();$("body").hasClass("onload-check")||h(function(){common.init()},1)});l.onError({},function(c){var b=c.error().detail?c.error().detail.redirectTo:null,e=c.error().type?c.error().type:0;if(b&&"login"==b){var e=c.$to().name,f=c.params("from");c=c.router.stateService.href(e,f);a.go(b,{ref:c})}else b?a.go(b):6==e&&a.go("root.error",{code:500})});b.listCourseActivity={};b.getCourseActivity=function(a){b.listCourseActivity[a]||dataService.getCourseActivity(a).then(function(c){b.listCourseActivity[a]=
c.data})};b.convertToShortDatetimeVN=function(a){return""!==a&&a?(a=new Date(1*a.toString().match(/\d+/)[0]),moment(a).format("DD/MM/YYYY HH:mm")):a};b.convertToDatetimeVN=function(a){return""!==a&&a?(a=new Date(1*a.toString().match(/\d+/)[0]),moment(a).format("DD/MM/YYYY HH:mm:ss")):a};b.generateAvatarUrl=function(a){return a&&-1==a.indexOf("http://")&&-1==a.indexOf("https://")?imageDomain+"avatar/"+a:a};b.closePopup=function(){a.transitionTo(a.$current.parent,a.params,{reload:!1,inherit:!1,notify:!0})};
b.clearCache=function(){f.clearAll();e.success("Cache cleared")};b.getStudentListData=["dataService","$stateParams",function(a,c){var b=a.getAllCourse(),e=a.getAllCenter();a=a.getStudentList(c);return d.all([b,e,a]).then(function(a){return{listCourse:a[0]?a[0].data:[],listCenter:a[1]?a[1].data:[],listData:a[2]?a[2].data:[]}})}];b.getUserListData=["dataService","$stateParams",function(a,c){var b=a.getUserType();a=a.getSystemUser(c);return d.all([b,a]).then(function(a){return{listUserType:a[0]?a[0].data:
[],listData:a[1]?a[1].data:[]}})}];b.initClassGroupListData=["dataService","$stateParams",function(a,c){var b=a.getAllCourse(),e=a.getAllCenter(),f=a.getAllTrainer(),h=a.getAllClassType();a=a.getAllGroupClass(c);return d.all([b,e,f,h,a]).then(function(a){return{listCourse:a[0]?a[0].data:[],listCenter:a[1]?a[1].data:[],listTrainer:a[2]?a[2].data:[],listClassType:a[3]?a[3].data:[],listData:a[4]?a[4].data:[]}})}];b.initAddClassGroupData=["dataService",function(a){var c=a.getAllCourse(),b=a.getAllCenter(),
e=a.getAllTrainer(),f=a.getAllClassType();a=a.getCourseHoliday();return d.all([c,b,e,f,a]).then(function(a){return{listCourse:a[0]?a[0].data:[],listCenter:a[1]?a[1].data:[],listTrainer:a[2]?a[2].data:[],listClassType:a[3]?a[3].data:[],listHoliday:a[4]?a[4].data:[]}})}];b.hasPermission=function(a){return 0<Enumerable.From(b.userRole).Count(function(c){return Enumerable.From(c.states).Any(function(c){return c.name==a})})}}]);app.config(["$qProvider",function(b){b.errorOnUnhandledRejections(!1)}]);
app.config(["NotificationProvider",function(b){b.setOptions({positionX:"center",positionY:"top",replaceMessage:!0})}]);app.config(["CacheFactoryProvider",function(b){angular.extend(b.defaults,{maxAge:864E5,deleteOnExpire:"aggressive",storagePrefix:"cms.cache.",storageMode:"memory"})}]);
app.config(["$httpProvider",function(b){b.defaults.xsrfHeaderName="x-dt-csrf-header";b.defaults.xsrfCookieName="X-CSRF-TOKEN";b.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";b.interceptors.push(["$q","$injector",function(b,a){return{response:function(a){return a},responseError:function(a){return a}}}])}]);
app.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(b,d,a){b.state("login",{url:"/login?ref",templateUrl:"app/login/views/login.html",controller:"Login as $vm",resolve:{isLogin:["$rootScope","$state","dataService",function(a,b,e){return e.getUserSession().then(function(a){if(a&&null!=a.data)if("root.home"!=b.current.name)b.go("root.home");else return $q.reject()})}]},data:{pageTitle:"Login"}}).state("root",{url:"",abstract:!0,resolve:{authData:["$rootScope","$state","dataService",
"$q",function(a,b,e,f){var c=f.defer();e.getUserSession().then(function(b){b&&null!=b.data?(a.sessionInfo=b.data,c.resolve(b.data)):c.reject({message:"Unauthenticate",redirectTo:"login"})});return c.promise}],userRole:["$rootScope","authData","sharedService",function(a,b,e){return e.getUserRole(b.userTypeId).then(function(b){return a.userRole=b})}]},views:{"":{templateUrl:"app/shared/views/_layout.html"},"header@root":{templateUrl:"app/shared/views/_header.html"},"leftMenu@root":{templateUrl:"app/shared/views/_leftMenu.html",
controller:"Shared.LeftMenu as $vm"}}}).state("root.home",{url:"/",templateUrl:"app/home/views/home.html",controller:"Home as $vm",data:{pageTitle:"Home"}}).state("root.schedule",{url:"/schedule?courseId\x26trainerId\x26centerId",templateUrl:"app/classSchedule/views/classSchedule.html",controller:"ClassSchedule as $vm",resolve:{viewModel:["classScheduleService","$stateParams","authData",function(a,b,e){return a.getClassSchedulePageData({isAdmin:1==e.userTypeId,nextDayNum:7,courseId:b.courseId,centerId:b.centerId,
trainerId:1==e.userTypeId?b.trainerId:e.userId}).then(function(a){return a})}]},data:{pageTitle:"Class Schedule"}}).state("root.schedule.classInfo",{url:"/class-info/{id:[0-9]{1,16}}/{view:student|report|report-detail}/{quizId:[0-9]{1,16}}",params:{view:{value:"student",squash:!1},quizId:{value:"0",squash:!0}},templateUrl:"app/classSchedule/views/classInfo.html",controller:"ClassSchedule.ClassInfo as $vm",resolve:{viewModel:["classInfoService","$stateParams","authData",function(a,b,e){return a.getClassInfoPageData({classId:b.id,
viewMode:b.view,quizId:b.quizId}).then(function(a){return a})}]},data:{pageTitle:"Class Info",isFullScreenPanel:!0}}).state("root.student",{url:"/student",abstract:!0,template:"\x3cui-view\x3e\x3c/ui-view\x3e"}).state("root.student.list",{url:"/list?searchKey\x26p\x26ps\x26studentStatus\x26courseId\x26centerId",params:{searchKey:{value:"",squash:!0},courseId:{value:"",squash:!0},centerId:{value:"",squash:!0},studentStatus:{value:"",squash:!0},p:{value:"1",squash:!0},ps:{value:"10",squash:!0}},templateUrl:"app/student/views/list.html",
controller:"Student.List as $vm",resolve:{viewModel:["studentService","$stateParams","authData",function(a,b,e){return a.getManageStudentPageData({searchKey:b.searchKey,centerId:b.centerId,courseId:b.courseId,studentStatus:b.studentStatus,p:b.p,ps:b.ps}).then(function(a){return a})}]},data:{pageTitle:"Manage Student"}}).state("root.student.list.add",{url:"/add",templateUrl:"app/student/views/add.html",controller:"Student.Add as $vm",resolve:{viewModel:["studentService","$stateParams","authData",function(a,
b,e){return a.getAddStudentPageData().then(function(a){return a})}]},data:{pageTitle:"Add New Student",isFullScreenPanel:!0}}).state("root.student.list.detail",{url:"/detail/{id:[0-9]{1,16}}/{course:[0-9]{1,16}}/{courseTraineeId:[0-9]{1,16}}/{tab:class|log-activity|lab-activity|contract}/{subtab:property|quiz|other}/:unitId/:lessonId",params:{tab:{value:"class"},subtab:{value:"property",squash:!0},unitId:{value:"",squash:!0},lessonId:{value:"",squash:!0}},resolve:{viewModel:["studentService","$stateParams",
function(a,b){return a.getStudentDetailPageData(b.id).then(function(a){return a})}],viewModelSub:["studentService","$stateParams","$q","viewModel",function(a,b,e,d){switch(b.tab){case "class":var c={traineeId:b.id,courseTraineeId:b.courseTraineeId};return a.getStudentClasses(c).then(function(a){d.listStudentClass=a.data;return d});case "log-activity":return c={traineeId:b.id,courseTraineeId:b.courseTraineeId},a.getStudentDetailLogActivityData(c).then(function(a){d.listCommentType=a.listCommentType;
d.listActivityLog=a.listActivityLog;return d});case "contract":return d;case "lab-activity":var f,c={lessonId:b.lessonId,courseTraineeId:b.courseTraineeId,unitId:b.unitId};switch(b.subtab){case "property":f=a.getStudentProperty(c);break;case "quiz":f=a.getStudentQuiz(c);break;case "other":f=a.getStudentOtherActivity(c)}return e.all([a.getCourseActivity(b.course),f]).then(function(a){d.listCourseActivity=a[0].data;d.listData=a[1].data;return d})}}]},views:{"":{templateUrl:"app/student/views/detail.html",
controller:"Student.Detail as $vm"},"@root.student.list.detail":{templateProvider:["$stateParams","$templateRequest",function(a,b){return b("app/student/views/detail-"+a.tab+".html")}],controllerProvider:["$stateParams",function(a){return"Student.Detail."+a.tab.replace(/\b\w/g,function(a){return a.toUpperCase()}).replace("-","")+" as $vm"}]}},data:{pageTitle:"Student Detail",isFullScreenPanel:!0}}).state("root.user",{url:"/user",abstract:!0,template:"\x3cui-view\x3e\x3c/ui-view\x3e"}).state("root.user.list",
{url:"/list?searchKey\x26p\x26ps\x26userStatus\x26userTypeId",params:{searchKey:{value:"",squash:!0},userTypeId:{value:"",squash:!0},userStatus:{value:"",squash:!0},p:{value:"1",squash:!0},ps:{value:"10",squash:!0}},templateUrl:"app/user/views/list.html",controller:"User.List as $vm",resolve:{viewModel:["userService","$stateParams","authData",function(a,b,e){return a.getManageUserPageData({searchKey:b.searchKey,userTypeId:b.userTypeId,userStatus:b.userStatus,p:b.p,ps:b.ps}).then(function(a){return a})}]},
data:{pageTitle:"Manage User"}}).state("root.user.list.add",{url:"/add",templateUrl:"app/user/views/add.html",controller:"User.Add as $vm",data:{pageTitle:"Add New User",isFullScreenPanel:!0}}).state("root.groupClass",{url:"/group-class",template:"\x3cui-view\x3e\x3c/ui-view\x3e","abstract":!0}).state("root.groupClass.list",{url:"/list?searchKey\x26classTypeId\x26p\x26ps\x26statusId\x26courseId\x26centerId\x26trainerId\x26weekView",params:{searchKey:{value:"",squash:!0},p:{value:"1",squash:!0},ps:{value:"10",
squash:!0},classTypeId:{value:"",squash:!0},statusId:{value:"",squash:!0},courseId:{value:"",squash:!0},centerId:{value:"",squash:!0},trainerId:{value:"",squash:!0},weekView:{value:"4",squash:!0}},templateUrl:"app/groupClass/views/list.html",controller:"GroupClass.List as $vm",resolve:{viewModel:["groupClassService","$stateParams","authData",function(a,b,e){return a.getManageGroupClassPageData({searchKey:b.searchKey,trainerId:b.trainerId,courseId:b.courseId,centerId:b.centerId,p:b.p,ps:b.ps,classTypeId:b.classTypeId,
statusId:b.statusId,weekView:b.weekView}).then(function(a){return a})}]},data:{pageTitle:"Manage Group Class"}}).state("root.groupClass.list.add",{url:"/add",templateUrl:"app/groupClass/views/add.html",controller:"GroupClass.Add as $vm",resolve:{viewModel:["groupClassService","viewModel",function(a,b){return a.getCourseHoliday().then(function(a){b.listHoliday=a;return b})}]},data:{pageTitle:"Add New Group Class",isFullScreenPanel:!0}}).state("root.catalouge",{url:"/catalouge?courseId\x26unitId\x26lessonId",
params:{courseId:{value:"0",squash:!0},unitId:{value:"0",squash:!0},lessonId:{value:"0",squash:!0}},templateUrl:"app/catalouge/views/list.html",controller:"Catalouge.List as $vm",resolve:{viewModel:["catalougeService","$stateParams",function(a,b){return a.getCatalougePageData({courseId:b.courseId,unitId:b.unitId,lessonId:b.lessonId}).then(function(a){return a})}]},data:{pageTitle:"Catalouge"}});b.state("root.error",{url:"/error/{code:401|404|500}",templateProvider:["$stateParams","$templateRequest",
function(a,b){return b("app/error/views/"+a.code+".html")}],data:{pageTitle:"Error"}});b.state("root.course",{url:"/course",abstract:!0,template:"\x3cui-view\x3e\x3c/ui-view\x3e"});b.state("root.course.manage",{url:"/{view:list|card}",params:{view:{value:"card"}},controller:"Course.Manage as $vm",templateProvider:["$stateParams","$templateRequest",function(a,b){return b("app/course/views/"+a.view+".html")}],resolve:{viewModel:["courseService","trainerService","authData","$q",function(a,b,e,d){var c=
d.defer();d.all([a.getListCourse({userId:e.userId,userTypeId:e.userTypeId}),b.getAllTrainer()]).then(function(a){c.resolve({listCourse:a[0].data,listTrainer:a[1].data})});return c.promise}]},data:{pageTitle:"Manage Course"}});d.otherwise("/error/404");a.html5Mode({enabled:!0,requireBase:!1});$stateProviderRef=b}]);
(function(){angular.module("app").service("baseService",["$http",function(b){this.baseUrl="/api";this.getData=function(d,a){return b.get(d,{params:a}).then(function(a){return a.data})};this.postData=function(d,a){return b.post(d,a).then(function(a){return a.data})}}])})();
(function(){angular.module("app").service("sharedService",["$http","baseService",function(b,d){this.doLogout=function(){return d.postData(d.baseUrl+"/doLogout")};this.getUserRole=function(a){return d.getData(d.baseUrl+"/getUserRole",{userTypeId:a})}}])})();
(function(){angular.module("app").service("notificationService",["Notification",function(b){this.error=function(d,a){b.error({message:d,delay:a?a:3E3})};this.success=function(d,a){b.success({message:d,delay:a?a:3E3})};this.info=function(d,a){b.info({message:d,delay:a?a:3E3})};this.warning=function(d,a){b.warning({message:d,delay:a?a:3E3})}}])})();
app.factory("dataService",["$http","CacheFactory","$timeout",function(b,d,a){var g=function(a){return b.post(a).then(function(a){return a.data})},h=function(a,d){return b.post(a,d).then(function(a){return a.data})};d.get("masterDataCache")||d.createCache("masterDataCache",{deleteOnExpire:"aggressive",recycleFreq:6E4});d.get("masterDataCache");return{getModules:function(a){return h("/api/getModules",a)},doLogin:function(a){return h("/api/doLogin",a)},doLogout:function(){return g("/api/doLogout")},
getUserSession:function(){return g("/api/getUserSession")},getStudentList:function(a){return h("/api/getStudentList",a)},getAllCenter:function(){return b.get("/api/getAllCenter").then(function(a){return a.data})},getAllCourse:function(){return b.get("/api/getAllCourse").then(function(a){return a.data})},getIntroClassByCenterAndCourse:function(a){return h("/api/getIntroClassByCenterAndCourse",a)},getIncomingFirstClass:function(a){return h("/api/getIncomingFirstClass",a)},addNewStudent:function(a){return h("/api/addNewStudent",
a)},getPendingCheckAttendanceClass:function(a){return h("/api/getPendingCheckAttendanceClass",a)},getIncomingClass:function(a){return h("/api/getIncomingClass",a)},getClassSchedule:function(a){return h("/api/getClassSchedule",a)},getClassInfoById:function(a){return h("/api/getClassInfoById",a)},getStudentByClass:function(a){return h("/api/getStudentByClass",a)},changeClassTrainer:function(a){return h("/api/changeClassTrainer",a)},changeClassTime:function(a){return h("/api/changeClassTime",a)},updateStudentAttendance:function(a){return h("/api/updateStudentAttendance",
a)},updateClassAttendanceCheck:function(a){return h("/api/updateClassAttendanceCheck",a)},getAllTrainer:function(){return b.get("/api/getAllTrainer").then(function(a){return a.data})},getStudentInfo:function(a){return h("/api/getStudentInfo",a)},getStudentClasses:function(a){return h("/api/getStudentClasses",a)},getStudentActivityLog:function(a){return h("/api/getStudentActivityLog",a)},getAllCommentType:function(){return g("/api/getAllCommentType")},getAllCommentResult:function(a){return h("/api/getAllCommentResult",
a)},resetStudentPassword:function(a){return h("/api/resetStudentPassword",a)},addActivityLog:function(a){return h("/api/addActivityLog",a)},getQuizReport:function(a){return h("/api/getQuizReport",a)},getQuizReportDetail:function(a){return h("/api/getQuizReportDetail",a)},getSystemUser:function(a){return h("/api/getSystemUser",a)},getUserType:function(){return b.get("/api/getUserType").then(function(a){return a.data})},addNewUser:function(a){return h("/api/addNewUser",a)},getStudentProperty:function(a){return h("/api/getStudentProperty",
a)},getStudentQuiz:function(a){return h("/api/getStudentQuiz",a)},getStudentOtherActivity:function(a){return h("/api/getStudentOtherActivity",a)},getCourseActivity:function(a){return h("/api/getCourseActivity",a)},getStudentAllCourse:function(a){return h("/api/getStudentAllCourse",a)},updateStudentCourseStatus:function(a){return h("/api/updateStudentCourseStatus",a)},getOfflineClassForRetake:function(a){return h("/api/getOfflineClassForRetake",a)},retakeStudentClass:function(a){return h("/api/retakeStudentClass",
a)},getUnitInCourse:function(a){return h("/api/getUnitInCourse",a)},getCourseHoliday:function(a){return h("/api/getCourseHoliday",a)},addNewGroupClass:function(a){return h("/api/addNewGroupClass",a)},getLessonInUnit:function(a){return h("/api/getLessonInUnit",a)},getActivityCatalouge:function(a){return h("/api/getActivityCatalouge",a)},getActivityDetails:function(a){return h("/api/getActivityDetails",a)},getQuizQuestion:function(a){return h("/api/getQuizQuestion",a)},getAllGroupClass:function(a){return h("/api/getAllGroupClass",
a)},getAllClassType:function(){return b.get("/api/getAllClassType").then(function(a){return a.data})},getUnitByCourseAndClassType:function(a){return h("/api/getUnitByCourseAndClassType",a)},extendGroupClass:function(a){return h("/api/extendGroupClass",a)}}}]);
app.service("notifyService",function(){this.error=function(d,a){b(d,"error",a)};this.success=function(d,a){b(d,"success",a)};var b=function(b,a,g){new PNotify({text:b,delay:void 0==g?1400:g,icon:!1,styling:"bootstrap3",type:a,width:"290px",animate:{animate:!1},buttons:{sticker:!1,closer:!1}})}});
app.service("progressService",["ngProgressFactory",function(b){var d=b.createInstance();d.setColor("#70ca63");this.start=function(){d.start()};this.complete=function(){d.complete()};this.status=function(){return d.status()};this.reset=function(){d.reset()}}]);app.service("fileUploader",["$http",function(b){this.uploadFileToUrl=function(d,a){var g=new FormData;g.append("file",d);return b.post(a,g,{transformRequest:angular.identity,headers:{"Content-Type":void 0}})}}]);
app.filter("gender",["genderArray",function(b){return function(d){return isNaN(d)?d:null!=d&&d?b[d]:"Unknown"}}]);app.filter("dateVN",function(){return function(b){return""!==b&&b?(b=new Date(1*b.toString().match(/\d+/)[0]),moment(b).format("DD/MM/YYYY")):b}});app.filter("dateToDateVN",function(){return function(b){return""!==b&&b?moment(b).format("DD/MM/YYYY"):b}});
app.filter("dateTimeShortVN",function(){return function(b){return""!==b&&b?(b=new Date(1*b.toString().match(/\d+/)[0]),moment(b).format("DD/MM/YYYY HH:mm")):b}});app.filter("dateTimeVN",function(){return function(b){return""!==b&&b?(b=new Date(1*b.toString().match(/\d+/)[0]),moment(b).format("DD/MM/YYYY HH:mm:ss")):b}});app.filter("unitCompletionPercent",function(){return function(b){return""!==b&&b?Math.round(100*b)+"%":"0%"}});
app.filter("unitScore",function(){return function(b){return""!==b&&b?Math.round(10*b)+"/10":"0/10"}});app.filter("unitTimeSpend",function(){return function(b){if(""!==b&&b){var d=new Date(1970,0,1);d.setSeconds(1*b.toString().match(/\d+/)[0]);return moment(d).format("HH:mm:ss")}return"00:00:00"}});
app.filter("splitRightAnswer",["$sce",function(b){return function(d){if(d){d=d.split("#@WSE@#");for(var a="",g=0;g<d.length;g++)""!=d[g]&&(a+='\x3ci class\x3d"fa fa-check text-success fa-fw"\x3e\x3c/i\x3e'+d[g]+"\x3cbr/\x3e");a=a.slice(0,-5);return b.trustAsHtml(a)}}}]);app.filter("sliceChar",function(){return function(b,d){d=Math.abs(d);return b&&b.length>d?b.slice(0,-d):b}});app.filter("trusted",["$sce",function(b){return function(d){return b.trustAsHtml(d)}}]);
app.directive("accessibleForm",function(){return{restrict:"A",link:function(b,d){d.on("submit",function(){var a=d[0].querySelector(".ng-invalid");a&&a.focus()})}}});app.directive("title",["$rootScope","$timeout","$transitions",function(b,d,a){return{link:function(){var g=function(a){d(function(){b.title=a.data&&a.data.pageTitle?a.data.pageTitle+" - Learning Management System":""})};a.onSuccess({},function(a){g(a.$to())})}}}]);
app.directive("passwordVerify",function(){return{require:"ngModel",scope:{passwordVerify:"\x3d"},link:function(b,d,a,g){b.$watch(function(){var a;if(b.passwordVerify||g.$viewValue)a=b.passwordVerify+"_"+g.$viewValue;return a},function(a){a&&g.$parsers.unshift(function(a){if(b.passwordVerify!==a)g.$setValidity("passwordVerify",!1);else return g.$setValidity("passwordVerify",!0),a})})}}});
app.directive("courseImagePicker",["$timeout",function(b){return{restrict:"E",scope:{isEnable:"\x3d",courseImage:"\x3d",fileModel:"\x3d"},templateUrl:"app/components/courseImagePicker.html",link:function(d,a,g){d.getImageUrl=function(a){return a?"-1"==a.indexOf("data:")?window.imageDomain+a:a:a};d.onSelectCourseImage=function(a){if(a=a.files[0]){d.fileModel=a;d.fileName=a.name;var e=new FileReader;e.onload=function(){b(function(){d.courseImage=e.result})};e.readAsDataURL(a)}}}}}]);
app.directive("onErrorSrc",function(){return{link:function(b,d,a){d.bind("error",function(){a.$set("src",b.noAvatarImgUrl)})}}});app.directive("numbersOnly",function(){return{require:"ngModel",link:function(b,d,a,g){g.$parsers.push(function(a){if(a){var b=a.replace(/[^0-9]/g,"");b!==a&&(g.$setViewValue(b),g.$render());return b}})}}});
app.directive("ngMin",function(){return{restrict:"A",require:"ngModel",link:function(b,d,a,g){b.$watch(a.ngMin,function(){g.$setViewValue(g.$viewValue)});b=function(b){var d=a.ngMin||0;if(angular.isUndefined(b)||""===b||null===b||b!==b)g.$setValidity("min",!0);else{if(isNaN(b)){g.$setValidity("number",!1);return}if(Number(b)<d){g.$setValidity("min",!1);return}}return b};g.$parsers.push(b);g.$formatters.push(b)}}});
app.directive("ngMax",function(){return{restrict:"A",require:"ngModel",link:function(b,d,a,g){b.$watch(a.ngMax,function(){g.$setViewValue(g.$viewValue)});b=function(b){var d=a.ngMax||Infinity;if(angular.isUndefined(b)||""===b||null===b||b!==b)g.$setValidity("max",!0);else{if(isNaN(b)){g.$setValidity("number",!1);return}if(Number(b)>d){g.$setValidity("max",!1);return}}return b};g.$parsers.push(b);g.$formatters.push(b)}}});
app.directive("ngRange",[function(){return{require:"ngModel",link:function(b,d,a,g){g&&(b=function(b){var d=a.ngRange.split(",").map(Number);if(angular.isUndefined(b)||""===b||null===b)return g.$setValidity("range",!0),"";if(isNaN(b))g.$setValidity("number",!1);else if(Number(b)<d[0]||Number(b)>d[1])g.$setValidity("range",!1);else return g.$setValidity("range",!0),b},g.$parsers.push(b),g.$formatters.push(b))}}}]);
app.directive("select2",function(){return{restrict:"A",require:"ngModel",link:function(b,d,a,g){$(d).select2()}}});
app.directive("datepicker",function(){return{restrict:"E",require:"ngModel",replace:!0,templateUrl:"app/components/datepicker.html",scope:{dateFormat:"@",dateMin:"@",dateMax:"@",placeholder:"@",daysOfWeekDisabled:"\x3d",outputFormat:"@",onSelect:"\x26",model:"\x3dngModel",ngClass:"\x3dngClass"},link:function(b,d,a,g){b.dateFormat=angular.isUndefined(b.dateFormat)?"DD/MM/YYYY":b.dateFormat;b.outputFormat=angular.isUndefined(b.outputFormat)?"YYYY-MM-DD":b.outputFormat;var h=$(d).find("input[type\x3dtext]:first"),
e=function(){void 0!==h.data("DateTimePicker")&&(h.data("DateTimePicker").destroy(),h.unbind("dp.change"));h.datetimepicker({format:b.dateFormat,useCurrent:!1,pickTime:!1,minDate:b.dateMin,daysOfWeekDisabled:b.daysOfWeekDisabled});h.on("dp.change",function(a){a=a.date?moment(a.date):null;var c="";if(null!=a){switch(b.outputFormat){case "timestamp":c=a.valueOf();break;default:c=a.format(b.outputFormat)}b.$apply(function(){g.$setViewValue(c)});if(void 0!==b.onSelect&&null!=a)b.onSelect({date:a,formatedDate:c,
weekDay:a.weekday()})}})};b.$watch("daysOfWeekDisabled",function(a,c){b.daysOfWeekDisabled=a;e()});b.$watch("dateMin",function(a,b){void 0!=a&&h.data("DateTimePicker").setMinDate(a)});b.$watch("dateMax",function(a,b){void 0!=a&&h.data("DateTimePicker").setMaxDate(a)});b.$watch("model",function(a,b){void 0===a&&h.data("DateTimePicker").setValue("")});e()}}});
app.directive("timepicker",function(){return{restrict:"E",require:"ngModel",replace:!0,templateUrl:"app/components/timepicker.html",scope:{timeFormat:"@",minuteStepping:"@",placeholder:"@",outputFormat:"@",onSelect:"\x26",model:"\x3dngModel",ngClass:"\x3dngClass"},link:function(b,d,a,g){b.timeFormat=angular.isUndefined(b.timeFormat)?"HH:mm":b.timeFormat;b.outputFormat=angular.isUndefined(b.outputFormat)?"HH:mm":b.outputFormat;b.minuteStepping=isNaN(b.minuteStepping)?1:Number(b.minuteStepping);b.selectedVal=
null;var h=$(d).find("input[type\x3dtext]:first");b.$watch("model",function(a,b){void 0===a&&h.data("DateTimePicker").setValue("")});(function(){void 0!==h.data("DateTimePicker")&&(h.data("DateTimePicker").destroy(),h.unbind("dp.change"));h.datetimepicker({format:b.timeFormat,useCurrent:!0,pickDate:!1,useSeconds:!1,minuteStepping:b.minuteStepping});h.on("dp.change",function(a){a=a.date?moment(a.date):null;var d="";if(null!=a){switch(b.outputFormat){case "timestamp":d=a.valueOf();break;default:d=a.format(b.outputFormat)}b.$apply(function(){g.$setViewValue(d)});
if(void 0!==b.onSelect&&null!=a)b.onSelect({date:a,formatedTime:d})}})})()}}});app.directive("fcEvent",function(){return{restrict:"E",replace:!0,templateUrl:"app/components/fc-event.html",scope:{event:"\x3d",style:"@",isAdmin:"\x3d"},link:function(b,d,a,g){d=b.event;b.eventClass="";d.isIncomingClass?b.eventClass="fc-event-primary":d.isCheckAttendance?b.eventClass="fc-event-success":d.isCheckAttendance||(b.eventClass="fc-event-warning")}}});
app.directive("pagination",["$rootScope","$state",function(b,d){return{restrict:"E",replace:!0,templateUrl:"app/components/paging.html",scope:{params:"\x3d",totalRow:"\x3d"},link:function(a,g,h){a.IsShowCount=!0;a.stateName=d.current.name;a.CountShowPage=6;a.pageNumber=a.params.p?a.params.p:1;a.rowPerPage=0;a.startNum=0;a.endNum=0;a.startIndex=1;a.endIndex=1;a.rowPerPage=a.params.ps?a.params.ps:b.defaultPageSize;a.totalPage=Math.ceil(a.totalRow/a.rowPerPage);a.startIndex=(a.pageNumber-1)*a.rowPerPage+
1;a.endIndex=Number(a.startIndex)+Number(a.rowPerPage)-1;a.endIndex=a.endIndex>=a.totalRow?a.totalRow:a.endIndex;a.pageNumber<=a.CountShowPage/2&&a.totalPage<=a.CountShowPage?(a.startNum=1,a.endNum=a.CountShowPage):a.pageNumber<=a.CountShowPage/2&&a.totalPage>a.CountShowPage?(a.startNum=1,a.endNum=a.CountShowPage-1):a.pageNumber>a.totalPage-a.CountShowPage/2&&a.totalPage>a.CountShowPage?(a.endNum=a.totalPage,a.startNum=a.endNum-a.CountShowPage/2-1):(a.startNum=a.pageNumber-a.CountShowPage/2+1,a.endNum=
a.startNum+a.CountShowPage/2);1>a.startNum&&(a.startNum=1);a.endNum>a.totalPage&&(a.endNum=a.totalPage);a.getNumber=function(a){return Array(a)};a.GoToPage=function(b,f){f.preventDefault();b!=a.params.p&&d.go(".",angular.extend(a.params,{p:b}),{notify:!1})};a.PreviousPage=function(){1<a.params.p&&d.go(".",angular.extend(a.params,{p:Number(a.params.p)-1}),{notify:!1})};a.NextPage=function(b){b.preventDefault();a.params.p<a.totalPage&&d.go(".",angular.extend(a.params,{p:Number(a.params.p)+1}),{notify:!1})};
a.$watch("totalRow",function(b){b&&(a.totalPage=Math.ceil(a.totalRow/a.rowPerPage),a.pageNumber<=a.CountShowPage/2&&a.totalPage<=a.CountShowPage?(a.startNum=1,a.endNum=a.CountShowPage):a.pageNumber<=a.CountShowPage/2&&a.totalPage>a.CountShowPage?(a.startNum=1,a.endNum=a.CountShowPage-1):a.pageNumber>a.totalPage-a.CountShowPage/2&&a.totalPage>a.CountShowPage?(a.endNum=a.totalPage,a.startNum=a.endNum-a.CountShowPage/2-1):(a.startNum=a.pageNumber-a.CountShowPage/2+1,a.endNum=a.startNum+a.CountShowPage/
2),1>a.startNum&&(a.startNum=1),a.endNum>a.totalPage&&(a.endNum=a.totalPage))});a.$watch("params.p",function(b){b&&(a.pageNumber=b,a.startIndex=(a.pageNumber-1)*a.rowPerPage+1,a.endIndex=Number(a.startIndex)+Number(a.rowPerPage)-1,a.endIndex=a.endIndex>=a.totalRow?a.totalRow:a.endIndex,a.pageNumber<=a.CountShowPage/2&&a.totalPage<=a.CountShowPage?(a.startNum=1,a.endNum=a.CountShowPage):a.pageNumber<=a.CountShowPage/2&&a.totalPage>a.CountShowPage?(a.startNum=1,a.endNum=a.CountShowPage-1):a.pageNumber>
a.totalPage-a.CountShowPage/2&&a.totalPage>a.CountShowPage?(a.endNum=a.totalPage,a.startNum=a.endNum-a.CountShowPage/2-1):(a.startNum=a.pageNumber-a.CountShowPage/2+1,a.endNum=a.startNum+a.CountShowPage/2),1>a.startNum&&(a.startNum=1),a.endNum>a.totalPage&&(a.endNum=a.totalPage))})}}}]);app.directive("bootstrapCollapse",function(){return{restrict:"A",link:function(b,d,a,g){$(d).collapse({toggle:!1})}}});
app.directive("dropdown",["$rootScope","$timeout",function(b,d){return{restrict:"E",templateUrl:"app/components/dropdown.html",scope:{placeholder:"@",list:"\x3d",selected:"\x3d",value:"@",text:"@",onSelect:"\x26?",allowFilter:"@",multiple:"@"},link:function(a,g,h){a.listVisible=!1;a.isPlaceholder=!0;a.select=function(b){if(void 0==b)a.selected=void 0,a.selectedItem=void 0,a.display="",a.isPlaceholder=!0;else if(void 0==a.multiple&&!a.isSelected(b))a.isPlaceholder=!1,a.selected=b[a.value].toString(),
a.selectedItem=b,a.display=void 0!==b?b[a.text]:"";else if(void 0==a.multiple&&a.isSelected(b))a.isPlaceholder=!0,a.selected=void 0,a.selectedItem=void 0;else if(void 0!=a.multiple&&(null==a.selected||!a.isSelected(b))){a.isPlaceholder=!1;var c=void 0!=a.selected?a.selected.split(","):[];c.push(b[a.value].toString());a.selected=c.join(",");a.display=1<c.length?c.length+" "+a.placeholder+" selected":b[a.text]}else if(void 0!=a.multiple&&a.isSelected(b)){var c=a.selected.split(","),f=c.indexOf(b[a.value].toString());
-1<f&&c.splice(f,1);a.selected=0==c.length?void 0:c.join(",");a.isPlaceholder=0==c.length;1<c.length?a.display=1<c.length?c.length+" "+a.placeholder+" selected":b[a.text]:1==c.length?(b=a.list.filter(function(b){return b[a.value]==a.selected})[0],a.display=b[a.text]):a.display=""}a.onSelect&&d(function(){a.onSelect()})};a.isSelected=function(b){return void 0==a.multiple?b[a.value].toString()==a.selected:-1!=(void 0!=a.selected?a.selected.split(","):[]).indexOf(b[a.value].toString())};a.show=function(){a.listVisible=
!a.listVisible};a.getList=function(){return a.filterInput&&void 0!=a.list?a.list.filter(function(b){return-1!=e(b[a.text]).indexOf(e(a.filterInput))}):a.list};a.clearFilter=function(){a.filterInput=""};a.clearSelect=function(){a.select()};a.isShowFilter=function(){return void 0===a.allowFilter?a.list&&5<a.list.length:"false"!=a.allowFilter};b.$on("documentClicked",function(b,c){!$(c[0]).is(".dropdown-display.clicked")&&0< !$(c[0]).parents(".dropdown-display.clicked").length&&!$(c[0]).is(".filter-input")&&
!$(c[0]).is(".clear-filter")?a.$apply(function(){a.listVisible=!1}):(b=g[0].querySelector(".filter-input"))&&b.focus()});var e=function(a){a=a.toLowerCase();a=a.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/ig,"a");a=a.replace(/À|Á|Ạ|Ả|Ã|Â|Ầ|Ấ|Ậ|Ẩ|Ẫ|Ă|Ằ|Ắ|Ặ|Ẳ|Ẵ/ig,"A");a=a.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e");a=a.replace(/È|É|Ẹ|Ẻ|Ẽ|Ê|Ề|Ế|Ệ|Ể|Ễ/g,"E");a=a.replace(/ì|í|ị|ỉ|ĩ/g,"i");a=a.replace(/Ì|Í|Ị|Ỉ|Ĩ/g,"I");a=a.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o");a=a.replace(/Ò|Ó|Ọ|Ỏ|Õ|Ô|Ồ|Ố|Ộ|Ổ|Ỗ|Ơ|Ờ|Ớ|Ợ|Ở|Ỡ/g,
"O");a=a.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u");a=a.replace(/Ù|Ú|Ụ|Ủ|Ũ|Ư|Ừ|Ứ|Ự|Ử|Ữ/g,"U");a=a.replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y");a=a.replace(/Ỳ|Ý|Ỵ|Ỷ|Ỹ/g,"Y");a=a.replace(/đ/g,"d");a=a.replace(/Đ/g,"d");var b={"ẻ":"ẻ","é":"é","è":"è","ẹ":"ẹ","ẽ":"ẽ","ể":"ể","ế":"ế","ề":"ề","ệ":"ệ","ễ":"ễ","ỷ":"ỷ","ý":"ý","ỳ":"ỳ","ỵ":"ỵ","ỹ":"ỹ","ủ":"ủ","ú":"ú","ù":"ù","ụ":"ụ","ũ":"ũ","ử":"ử","ứ":"ứ","ừ":"ừ","ự":"ự","ữ":"ữ","ỉ":"ỉ","í":"í","ì":"ì","ị":"ị","ĩ":"ĩ","ỏ":"ỏ","ó":"ó","ò":"ò","ọ":"ọ",
"õ":"õ","ở":"ở","ớ":"ớ","ờ":"ờ","ợ":"ợ","ỡ":"ỡ","ổ":"ổ","ố":"ố","ồ":"ồ","ộ":"ộ","ỗ":"ỗ","ả":"ả","á":"á","à":"à","ạ":"ạ","ã":"ã","ẳ":"ẳ","ắ":"ắ","ằ":"ằ","ặ":"ặ","ẵ":"ẵ","ẩ":"ẩ","ấ":"ấ","ầ":"ầ","ậ":"ậ","ẫ":"ẫ","Ẻ":"Ẻ","É":"É","È":"È","Ẹ":"Ẹ","Ẽ":"Ẽ","Ể":"Ể","Ế":"Ế","Ề":"Ề","Ệ":"Ệ","Ễ":"Ễ","Ỷ":"Ỷ","Ý":"Ý","Ỳ":"Ỳ","Ỵ":"Ỵ","Ỹ":"Ỹ","Ủ":"Ủ","Ú":"Ú","Ù":"Ù","Ụ":"Ụ","Ũ":"Ũ","Ử":"Ử","Ứ":"Ứ","Ừ":"Ừ","Ự":"Ự","Ữ":"Ữ","Ỉ":"Ỉ","Í":"Í","Ì":"Ì","Ị":"Ị","Ĩ":"Ĩ",
"Ỏ":"Ỏ","Ó":"Ó","Ò":"Ò","Ọ":"Ọ","Õ":"Õ","Ở":"Ở","Ớ":"Ớ","Ờ":"Ờ","Ợ":"Ợ","Ỡ":"Ỡ","Ổ":"Ổ","Ố":"Ố","Ồ":"Ồ","Ộ":"Ộ","Ỗ":"Ỗ","Ả":"Ả","Á":"Á","À":"À","Ạ":"Ạ","Ã":"Ã","Ẳ":"Ẳ","Ắ":"Ắ","Ằ":"Ằ","Ặ":"Ặ","Ẵ":"Ẵ","Ẩ":"Ẩ","Ấ":"Ấ","Ầ":"Ầ","Ậ":"Ậ","Ẫ":"Ẫ"},d;for(d in b)a=a.replace(new RegExp(d,"g"),b[d]);return a};a.$watch("list",function(b){a.isPlaceholder=void 0===a.selected;if(a.list)if(b=a.list.filter(function(b){return b[a.value]==a.selected})[0],void 0==a.multiple)a.display=void 0!==
b?b[a.text]:"";else{var c=void 0!=a.selected?a.selected.split(","):[];a.display=1<c.length?c.length+" "+a.placeholder+" selected":void 0!==b?b[a.text]:""}});a.$watch("selected",function(b){a.isPlaceholder=void 0===a.selected;a.list&&(b=a.list.filter(function(b){return b[a.value]==a.selected})[0],a.display=b?b[a.text]:"")})}}}]);
app.directive("selectOnFocus",["$window",function(b){return{restrict:"A",link:function(d,a,g){a.on("focus",function(){b.getSelection().toString()||this.setSelectionRange(0,this.value.length)})}}}]);(function(){angular.module("app").controller("Shared.LeftMenu",["$scope","userRole",function(b,d){this.userRole=d;this.hasSubMenu=function(a){return a.states&&0<Enumerable.From(a.states).Count("$.isShowMenu")};this.isSingleMenu=function(a){return 1==Enumerable.From(a.states).Count("$.isShowMenu")}}])})();
(function(){angular.module("app").controller("Home",["$scope",function(b){}])})();
(function(){angular.module("app").controller("Login",["$scope","loginService","$timeout","$state","$location","progressService",function(b,d,a,g,h,e){var f=this;a(function(){angular.element(document.querySelector("#txtEmail")).focus()});f.isSubmitAttempt=!1;f.isInvalidField=function(a){return a.$invalid&&(a.$dirty||f.isSubmitAttempt)};f.doLogin=function(){f.isLoginError=!1;f.isSubmitAttempt=!0;f.loginForm.$valid&&(e.start(),d.doLogin(f.loginInfo).then(function(a){e.complete();a&&a.data?g.go("root.home"):
f.isLoginError=!0}))}}])})();
(function(){angular.module("app").controller("ClassSchedule",["$scope","$state","$compile","$timeout","progressService","viewModel","authData","classScheduleService",function(b,d,a,g,h,e,f,c){var l=this;l.isAdmin=1==f.userTypeId;l.params=d.params;l.nextDayNum=7;l.listIncomingClass=e.listIncomingClass;l.listPendingCheckAttendanceClass=e.listPendingCheckAttendanceClass;l.listCourse=e.listCourse;l.listCenter=e.listCenter;l.listTrainer=e.listTrainer;$("#calendar").fullCalendar({header:{left:"prev,next today",center:"title",
right:"month,listMonth,agendaWeek,listWeek,agendaDay,listDay"},lang:"en",editable:!1,timeFormat:"h:mma ",buttonText:{month:"Month",agendaWeek:"Week",agendaDay:"Day",today:"Today",listWeek:"List Week",listMonth:"List Month",listDay:"List Day"},noEventsMessage:"No class to display",viewRender:function(a){"month"==a.name||"agendaWeek"!=a.name&&"agendaDay"!=a.name||$("#calendar").fullCalendar("option","contentHeight",1025)},eventRender:function(a,b){$(b).attr("data-original-title",a.title)},eventAfterRender:function(c,
d){d=angular.element(d);c="\x3cfc-event event\x3d'"+JSON.stringify(c)+"' is-admin\x3d'"+l.isAdmin+"'\x3e\x3c/fc-event\x3e";c=a(c)(b);d.replaceWith(c)},eventClick:function(a){d.go("root.schedule.classInfo",{id:a.classId},{reload:!1})},eventSources:[{events:function(a,e,n,g){var h=[];c.getClassSchedule({isAdmin:l.isAdmin,courseId:d.params.courseId,centerId:d.params.centerId,trainerId:1==f.userTypeId?d.params.trainerId:f.userId,startDate:a,endDate:e}).then(function(a){var c=[];angular.forEach(a.data,
function(a){var d=!1,n=moment(a.studyDateTime).format(b.SERVER_DATE_FORMAT);-1!=h.indexOf(n)?d=!0:h.push(n);c.push(angular.extend(a,{title:a.unitTitle+" - "+a.centerName+" - "+a.teacherName,start:moment(a.studyDateTime).format(b.FULL_CALENDAR_DATE_TIME_FORMAT),isLimit:d,allDay:!1}))});g(c)})}}]});b.$watch("parentLoaded",function(a){a&&$q.all([getAllCourse(),getPendingCheckAttendanceClass(),getIncomingClass(),getAllTrainer(),getAllCenter()]).then(function(){g(function(){$(".select2").select2()})})});
l.FilterSchedule=function(){d.go(d.current,l.params,{reload:!0})}}])})();
(function(){angular.module("app").controller("ClassSchedule.ClassInfo",["$scope","$state","progressService","viewModel","authData","classInfoService","notificationService",function(b,d,a,g,h,e,f){var c=this,l=d.params.id;c.listStudent=g.listStudent;c.classInfo=g.classInfo;c.viewMode=d.params.view;c.listQuizReport=g.listQuizReport;c.listQuizReportDetail=g.listQuizReportDetail;c.QuizReportDetailView=1;c.isMyClass=c.classInfo.teacherId==h.userId;c.getViewTemplate=function(){var a="";switch(c.viewMode){case "student":a=
"/app/classSchedule/views/_listAttendant.html";break;case "report":a="/app/classSchedule/views/_quizReport.html";break;case "report-detail":a="/app/classSchedule/views/_quizReportDetail.html"}return a};c.checkAttendanceStudent=function(a){e.updateStudentAttendance({classId:l,trainerId:h.userId,studentId:a.userId,status:a.isAttended}).then(function(b){1!=b.data.id&&(f.error(b.data.message),a.isAttended=!a.isAttended)})};c.isAllStudentAttendanceCheck=function(){return c.listStudent&&0==Enumerable.From(c.listStudent).Count(function(a){return null==
a.isAttended})};c.updateClassAttendanceCheck=function(){e.updateClassAttendanceCheck({classId:l,trainerId:h.userId}).then(function(a){1==a.data.id?f.success(a.data.message):f.error(a.data.message)})};c.initChangeTrainer=function(){c.isUpdateTrainer=!0;0==c.listTrainer.length&&dataService.getAllTrainer().then(function(a){c.listTrainer=a.data})};c.changeClassTrainer=function(){currentTrainerId!=c.classInfo.teacherId?dataService.changeClassTrainer({isAdmin:b.isAdmin,classId:l,trainerId:b.sessionUserId,
newTrainerId:c.classInfo.teacherId}).then(function(a){1==a.data.id?(b.notifyService.success(a.data.message),currentTrainerId=c.classInfo.teacherId,c.classInfo.teacherName=Enumerable.From(c.listTrainer).First(function(a){return a.userId==currentTrainerId}).fullName,c.isUpdateTrainer=!1):b.notifyService.error(a.data.message)}):c.isUpdateTrainer=!1};c.cancelChangeTrainer=function(){c.isUpdateTrainer=!1};c.initChangeClassTime=function(){c.isUpdateClassTime=!0;$timeout(function(){$("#dtClassTime").datetimepicker({useCurrent:!1,
format:"DD/MM/YYYY HH:mm",minuteStepping:15});$("#dtClassTime").on("dp.change",function(a){c.classInfo.studyDateTime=a.date?moment(a.date).valueOf():""})},1)};c.changeClassTime=function(){""==c.classInfo.studyDateTime?b.notifyService.error("Class time can not be blank"):currentClassTime!=c.classInfo.studyDateTime?dataService.changeClassTime({isAdmin:b.isAdmin,classId:l,trainerId:b.sessionUserId,newClassTime:c.classInfo.studyDateTime}).then(function(a){1==a.data.id?(b.notifyService.success(a.data.message),
currentTrainerId=c.classInfo.studyDateTime,c.isUpdateClassTime=!1):b.notifyService.error(a.data.message)}):c.isUpdateClassTime=!1};c.cancelChangeClassTime=function(){c.isUpdateClassTime=!1};var k=function(){var a=$q.defer();dataService.getQuizReport(l).then(function(b){c.listQuizReport=b.data;a.resolve()});return a.promise};c.changeTab=function(a){c.currentTab=a;switch(a){case 2:c.listQuizReport||$q.when(k()).then(function(){})}};var m=function(){var a=$q.defer();dataService.getQuizReportDetail({classId:l,
activityId:c.currentReportDetailId}).then(function(b){c.listQuizReportDetail=b.data;a.resolve()});return a.promise};c.viewReportDetail=function(a){c.currentTab=3;c.currentReportDetailId!=a&&(c.currentReportDetailId=a,$q.when(m()).then(function(){c.QuizReportDetailView=c.QuizReportDetailView?c.QuizReportDetailView:1}))};c.getQuizReportStudentDetail=function(a){return Enumerable.From(c.listQuizReportDetail.listStudentDetail).Where(function(b){return b.userId==a}).ToArray()};c.calculateQuestionPercent=
function(a){var b=Enumerable.From(c.listQuizReportDetail.listStudentDetail).Count(function(b){return b.questionId==a&&b.isTraineeAnswerRight}),b=Number(b/c.listQuizReportDetail.listStudent.length*100);return Math.round(b)!==b?b.toFixed(2):b};c.calculateStudentRightPercent=function(a){a=a/c.listQuizReportDetail.reportSummary.numberOfQuestion*100;return Math.round(a)!==a?a.toFixed(2):a};c.getTraineeAnswerRightByAnswer=function(a,b){return Enumerable.From(c.listQuizReportDetail.listStudentDetail).First(function(c){return c.userId==
a&&c.questionId==b}).isTraineeAnswerRight?"1":"0"}}])})();
(function(){angular.module("app").controller("Student.List",["$scope","$state","$timeout","progressService","viewModel",function(b,d,a,g,h){var e=this;e.params=d.params;e.listCourse=h.listCourse;e.listCenter=h.listCenter;e.params=d.params;e.listStudent=h.listStudent;e.totalRow=e.listStudent&&0<e.listStudent.length?e.listStudent[0].totalRow:0;e.listCourse.unshift({courseId:"",courseTitle:"All"});e.listCenter.unshift({centerId:"",centerName:"All"});e.listStudentStatus=[{value:"",name:"All"},{value:"true",
name:"Active"},{value:"false",name:"Deactive"}];a(function(){angular.element(document.querySelector("#txtSearchKey")).focus()});e.SearchStudent=function(){e.params.p=1;e.totalRow=0;d.go(d.current,e.params)}}])})();
(function(){angular.module("app").controller("Student.Add",["$scope","$rootScope","$state","$q","$timeout","progressService","notificationService","studentService","viewModel",function(b,d,a,g,h,e,f,c,l){var k=this;k.isAttemptSubmit=!1;k.listCenter=l.listCenter;k.listCourse=l.listCourse;k.StudentInfo={};h(function(){angular.element(document.querySelector("#txtFirstName")).focus()});k.onChangeCenterOrCourse=function(){if(k.StudentInfo.courseId&&k.StudentInfo.centerId){var a={centerId:k.StudentInfo.centerId,
courseId:k.StudentInfo.courseId};e.start();c.getIncomingIntroClass(a).then(function(a){k.listIntroClass=a.data;e.complete()})}else k.listIntroClass=[],k.listIncomingFirstClass=[]};k.onChangeIntroductionClass=function(){if(k.StudentInfo.introClassId){var a=Enumerable.From(k.listIntroClass).First("$.classId \x3d\x3d "+k.StudentInfo.introClassId),a={centerId:k.StudentInfo.centerId,courseId:k.StudentInfo.courseId,introClassTime:a.studyDateTime};e.start();c.getIncomingNormalClass(a).then(function(a){e.complete();
k.listNormalClass=a.data})}else k.listNormalClass=[]};k.generateIntroClassName=function(a){return d.convertToShortDatetimeVN(a.studyDateTime)+" - "+a.centerName+" - "+a.trainerName+" ("+a.limitUser+")"};k.generateNormalClassName=function(a){return d.convertToShortDatetimeVN(a.studyDateTime)+" - "+a.centerName+" - "+a.trainerName+" ("+a.limitUser+")"};k.addNewStudent=function(){console.log(k.StudentInfo);k.isAttemptSubmit=!0;k.addNewStudentForm.$valid&&(k.StudentInfo.createdBy=b.sessionInfo.userId,
k.StudentInfo.avatarUrl=k.selectImageDisplay,e.start(),c.addNewStudent(k.StudentInfo).then(function(b){1==b.data.id?(f.success(b.data.message),a.go(a.$current.parent,a.params,{reload:!0})):(e.complete(),f.error(b.data.message))}))}}])})();
(function(){angular.module("app").controller("Student.Detail",["$scope","$q","$state","studentService","notificationService","viewModel","authData",function(b,d,a,g,h,e,f){var c=this,l=a.params.id;c.params=a.params;c.courseId=a.params.course;c.courseTraineeId=a.params.courseTraineeId;c.studentInfo=e.studentInfo;c.listStudentCourse=e.listStudentCourse;c.resetPassword=function(){bootbox.confirm("Are you sure want to reset student password? \x3cbr/\x3e Student password will reset to \x3cstrong class\x3d'text-danger'\x3e"+
b.defaultPassword+"\x3c/strong\x3e.",function(a){a&&g.resetStudentPassword({actionUser:f.userId,studentId:l,newPassword:b.defaultPassword}).then(function(a){1==a.data.id?h.success(a.data.message):h.error(a.data.message)})})};c.changeToCourse=function(b){c.params.course=b.courseId;c.params.courseTraineeId=b.courseTraineeId;a.go(".",c.params,{reload:!0})}}])})();
(function(){angular.module("app").controller("Student.Detail.Class",["$scope","$state","studentService","notificationService","viewModelSub","authData",function(b,d,a,g,h,e){var f=this;f.listStudentClass=h.listStudentClass;f.courseTraineeId=d.params.courseTraineeId;f.showPopupRetake=!1;f.retakeClass=function(b){a.getOfflineClassForRetake(b.unitId).then(function(a){f.listRetakeClass=a.data;f.retakeUnitTitle=b.unitTitle;f.retakeInfo={classId:0,oldClassId:b.classId,unitId:b.unitId};f.showPopupRetake=
!0})};f.bookRetakeClass=function(){f.retakeInfo.classId&&0<f.retakeInfo.classId?(f.retakeInfo.courseTraineeId=f.courseTraineeId,f.retakeInfo.createdBy=e.userId,a.retakeStudentClass(f.retakeInfo).then(function(a){1==a.data.id?(g.success(a.data.message),d.reload()):g.error(a.data.message)})):g.error("Choose a class to book")}}])})();
(function(){angular.module("app").controller("Student.Detail.LogActivity",["$scope","$q","$state","studentService","notificationService","viewModelSub","authData",function(b,d,a,g,h,e,f){var c=this,l=a.params.id;c.courseId=a.params.course;c.courseTraineeId=a.params.courseTraineeId;c.listActivityLog=e.listActivityLog;c.listCommentType=e.listCommentType;c.isAttemptSubmit=!1;c.onChangeCommentType=function(){c.newActivityLog.commentTypeId?g.getAllCommentResult(c.newActivityLog.commentTypeId).then(function(a){c.listCommentResult=
a.data}):c.listCommentResult=[];c.newActivityLog.commentResultId=null};c.resetForm=function(){c.isAttemptSubmit=!1;c.newActivityLog={}};c.addActivityLog=function(){c.isAttemptSubmit=!0;if(c.addActivityLogForm.$valid){var b=angular.extend(c.newActivityLog,{trainerId:f.userId,courseTraineeId:c.courseTraineeId,studentId:l});g.addActivityLog(b).then(function(b){-1!=b.data.id?(h.success(b.data.message),a.reload()):h.error(b.data.message)})}}}])})();
(function(){angular.module("app").controller("Student.Detail.Contract",["$scope","$q","$state","studentService","notificationService","viewModelSub","authData",function(b,d,a,g,h,e,f){this.listStudentCourse=e.listStudentCourse;this.updateStudentCourseStatus=function(a){bootbox.confirm(a.isActive?"Are you sure want to active student course?":"Are you sure want to deactive student course?",function(c){c?(c={},c={courseTraineeId:a.courseTraineeId,currentStatus:!a.isActive,newStatus:a.isActive},g.updateStudentCourseStatus(c).then(function(b){1==
b.data.id?h.success(b.data.message):(a.isActive=!a.isActive,h.error(b.data.message))})):b.$apply(function(){a.isActive=!a.isActive})})}}])})();
(function(){angular.module("app").controller("Student.Detail.LabActivity",["$scope","$q","$state","studentService","notificationService","viewModelSub","authData",function(b,d,a,g,h,e,f){var c=this;c.listCourseActivity=e.listCourseActivity;c.listData=e.listData;c.params=a.params;var l=[],k=[];c.labActivityFilter={unitId:"",lessonId:""};var m=null;c.getUnitInCourse=function(){c.listCourseActivity&&0==l.length&&(l=Enumerable.From(c.listCourseActivity).Distinct("$.unitId").Select("{unitId: $.unitId, unitTitle: $.unitTitle}").ToArray(),
l.unshift({unitId:"",unitTitle:"All unit"}));return l};c.getLessonByUnit=function(a){c.listCourseActivity&&a!=m&&(m=a,k=Enumerable.From(c.listCourseActivity).Distinct("$.lessonId").Where(function(b){return b.unitId==a}).Select("{lessonId: $.lessonId, lessonTitle: $.lessonTitle}").ToArray(),k.unshift({lessonId:"",lessonTitle:"All lesson"}));return k};c.getTemplate=function(){return"/app/student/views/lab-activity/"+a.params.subtab+".html"};c.getTotalWrongAnswer=function(a){return Enumerable.From(a).Count(function(a){return!a.isTraineeAnswerRight})};
c.getTotalRightAnswer=function(a){return Enumerable.From(a).Count(function(a){return a.isTraineeAnswerRight})};c.getTotalQuestion=function(a){return a.length};c.showQuizDetail=function(a){a.isShowDetail=void 0==a.isShowDetail?!1:a.isShowDetail;a.isShowDetail=!a.isShowDetail};c.reloadData=function(b){c.params.lessonId=b?"":c.params.lessonId;a.go(".",c.params,{reload:!0})}}])})();
function studentLabActivityCtrl(b,d,a,g,h,e){var f=this;f.courseId=a.params.course;f.courseTraineeId=a.params.courseTraineeId;f.currentLabTab=a.params.st?a.params.st:"property";f.labActivityFilter={unitId:void 0,lessonId:void 0};var c=function(){f.listStudentProperty=null;var a=g.defer();h.getStudentProperty({lessonId:f.labActivityFilter.lessonId,courseTraineeId:f.courseTraineeId,unitId:f.labActivityFilter.unitId}).then(function(b){f.listStudentProperty=b.data;a.resolve()});return a.promise},l=function(){f.listStudentOtherActivity=
null;var a=g.defer();h.getStudentQuiz({lessonId:f.labActivityFilter.lessonId,courseTraineeId:f.courseTraineeId,unitId:f.labActivityFilter.unitId}).then(function(b){f.listStudentQuiz=b.data;a.resolve()});return a.promise},k=function(){f.listStudentOtherActivity=null;var a=g.defer();h.getStudentOtherActivity({lessonId:f.labActivityFilter.lessonId,courseTraineeId:f.courseTraineeId,unitId:f.labActivityFilter.unitId}).then(function(b){f.listStudentOtherActivity=b.data;a.resolve()});return a.promise};f.changeLabActivityTab=
function(b){b=b?b:a.params.st;a.params.st=b;f.currentLabTab=b;b=[];switch(f.currentLabTab){case "property":b.push(c());break;case "quiz":b.push(l());break;case "other":b.push(k())}g.all(b).then(function(){e(function(){$(".select2").select2();$(".select2-nosearch").select2({minimumResultsForSearch:-1})});a.transitionTo(a.current,a.params,{reload:!1,inherit:!1,notify:!0})})};var m=[],n=[],p=null;f.getUnitInCourse=function(){b.listCourseActivity[f.courseId]&&0==m.length&&(m=Enumerable.From(b.listCourseActivity[f.courseId]).Distinct("$.unitId").Select("{unitId: $.unitId, unitTitle: $.unitTitle}").ToArray());
return m};f.getLessonByUnit=function(a){b.listCourseActivity[f.courseId]&&a!=p&&(p=a,n=Enumerable.From(b.listCourseActivity[f.courseId]).Distinct("$.lessonId").Where(function(b){return b.unitId==a}).Select("{lessonId: $.lessonId, lessonTitle: $.lessonTitle}").ToArray());return n};f.getTotalWrongAnswer=function(a){return Enumerable.From(a).Count(function(a){return!a.isTraineeAnswerRight})};f.getTotalRightAnswer=function(a){return Enumerable.From(a).Count(function(a){return a.isTraineeAnswerRight})};
f.getTotalQuestion=function(a){return a.length};f.showQuizDetail=function(a){a.isShowDetail=void 0==a.isShowDetail?!1:a.isShowDetail;a.isShowDetail=!a.isShowDetail};d=[];d.push(b.getCourseActivity(f.courseId));switch(f.currentLabTab){case "property":d.push(c());break;case "quiz":d.push(l());break;case "other":d.push(k())}g.all(d).then(function(){});f.onChangeUnit=function(){f.labActivityFilter.lessonId=void 0;f.changeLabActivityTab()}}studentLabActivityCtrl.$inject="$scope $rootScope $state $q dataService $timeout".split(" ");
app.controller("studentLabActivityCtrl",studentLabActivityCtrl);
(function(){angular.module("app").controller("User.List",["$scope","$state","$timeout","progressService","viewModel",function(b,d,a,g,h){var e=this;a(function(){angular.element(document.querySelector("#txtSearchKey")).focus()});e.listUserType=h.listUserType;e.listUser=h.listUser;e.params=d.params;e.listUserStatus=[{value:"",name:"All"},{value:"true",name:"Active"},{value:"false",name:"Deactive"}];e.listUserType.unshift({userTypeId:"",userTypeName:"All"});e.totalRow=e.listUser&&0<e.listUser.length?
e.listUser[0].totalRow:0;e.SearchUser=function(){e.params.p=1;e.totalRow=0;d.go(d.current,e.params,{notify:!1})}}])})();
(function(){angular.module("app").controller("User.Add",["$scope","$state","$timeout","userService","notificationService","viewModel",function(b,d,a,g,h,e){var f=this;f.listUserType=e.listUserType;f.UserInfo={userTypeId:""};f.isAttemptSubmit=!1;f.listUserType.splice(0,1);a(function(){angular.element(document.querySelector("#txtFirstName")).focus()});f.addNewUser=function(){f.isAttemptSubmit=!0;f.addNewUserForm.$valid&&(f.UserInfo.createdBy=b.sessionInfo.userId,progressService.start(),g.addNewUser(f.UserInfo).then(function(a){1==
a.data.id?(h.success(a.data.message),d.go(d.$current.parent,d.params,{reload:!0})):(progressService.complete(),h.error(a.data.message))}))}}])})();
(function(){angular.module("app").controller("GroupClass.List",["$scope","$state","$timeout","progressService","notificationService","groupClassService","viewModel",function(b,d,a,g,h,e,f){var c=this;a(function(){angular.element(document.querySelector("#txtSearchKey")).focus()});c.listCourse=f.listCourse;c.listCenter=f.listCenter;c.listTrainer=f.listTrainer;c.listClassType=f.listClassType;c.params=d.params;c.listGroupClass=f.listGroupClass;c.listStatus=[{value:"",name:"All"},{value:"true",name:"Active"},
{value:"false",name:"Deactive"}];c.listViewWeek=[{value:"4",name:"4 Weeks"},{value:"8",name:"8 Weeks"},{value:"12",name:"12 Weeks"},{value:"16",name:"16 Weeks"},{value:"20",name:"20 Weeks"},{value:"24",name:"24 Weeks"}];c.listCourse.unshift({courseId:"",courseTitle:"All"});c.listCenter.unshift({centerId:"",centerName:"All"});c.listTrainer.unshift({userId:"",fullName:"All"});c.listClassType.unshift({classTypeId:"",classTypeName:"All"});c.totalRow=c.listGroupClass&&0<c.listGroupClass.length?c.listGroupClass[0].totalRow:
0;c.SearchGroupClass=function(){c.params.p=1;c.totalRow=0;d.go(d.current,c.params,{notify:!1})};b.$watch(function(){return c.listGroupClass},function(a){c.listWeek=a&&0<a.length?c.listGroupClass[0].listSchedule:[]});c.extendGroupClass=function(a){bootbox.confirm("Extend group \x3cstrong\x3e"+a.groupClassName+"\x3c/strong\x3e ?",function(c){c&&(g.start(),e.extendGroupClass({groupClassId:a.groupClassId,modifiedBy:b.sessionUserId}).then(function(a){g.complete();1==a.data.id?(h.success(a.data.message),
d.go(".",d.params,{reload:!0})):h.error(a.data.message)}))})}}])})();
(function(){angular.module("app").controller("GroupClass.Add",["$scope","$state","$timeout","progressService","groupClassService","notificationService","viewModel",function(b,d,a,g,h,e,f){var c=this;a(function(){angular.element(document.querySelector("#txtEmail")).focus()});c.isSubmitAttempt=!1;c.params=d.params;c.listCourse=f.listCourse;c.listCenter=f.listCenter;c.listTrainer=f.listTrainer;c.listClassType=f.listClassType;c.listHoliday=f.listHoliday;c.listCourse.splice(0,1);c.listCenter.splice(0,
1);c.listTrainer.splice(0,1);c.listClassType.splice(0,1);c.listWeekDay=[{value:"0",name:"Sunday"},{value:"1",name:"Monday"},{value:"2",name:"Tuesday"},{value:"3",name:"Webnesday"},{value:"4",name:"Thursday"},{value:"5",name:"Friday"},{value:"6",name:"Saturday"}];c.newGroupClassInfo={startDayInWeek:"",centerId:"",courseId:"",trainerId:"",classTypeId:"",unitStartId:""};c.listCourseUnit=[];c.daysOfWeekDisabled=[];c.listClassDate=[];c.addNewGroupClass=function(){c.isSubmitAttempt=!0;c.addNewGroupClassForm.$valid?
(c.newGroupClassInfo.createdBy=b.sessionUserId,h.addNewGroupClass(c.newGroupClassInfo).then(function(a){1==a.data.id?(e.success(a.data.message),d.transitionTo(d.$current.parent,d.params,{reload:!0})):e.error(a.data.message)})):angular.forEach(c.addNewGroupClassForm.$error,function(a){angular.forEach(a,function(a){a.$setDirty()})})};c.onSelectCourseOrClassType=function(){c.newGroupClassInfo.unitStartId="";c.listCourseUnit=[];if(c.newGroupClassInfo.courseId&&c.newGroupClassInfo.classTypeId){var a={courseId:c.newGroupClassInfo.courseId,
classTypeId:c.newGroupClassInfo.classTypeId};g.start();h.getUnitByCourseAndClassType(a).then(function(a){a.data&&0<a.data.length&&(c.listCourseUnit=c.listCourseUnit.concat(a.data),c.getListClassDate());g.complete()})}};c.onSelectClassDay=function(){if(""==c.newGroupClassInfo.startDayInWeek||isNaN(c.newGroupClassInfo.startDayInWeek))c.daysOfWeekDisabled=[];else{var a=Number(c.newGroupClassInfo.startDayInWeek);c.daysOfWeekDisabled=[0,1,2,3,4,5,6];var b=c.daysOfWeekDisabled.indexOf(a);-1<b&&c.daysOfWeekDisabled.splice(b,
1);moment(new Date(c.newGroupClassInfo.startDate)).weekday()!=a&&(c.newGroupClassInfo.startDate=void 0)}};c.onSelectStartDate=function(b){a(function(){c.newGroupClassInfo.startDayInWeek=b.toString();c.getListClassDate()})};c.getListClassDate=function(){var a=[],b=Enumerable.From(c.listCourseUnit).Where(function(a){return""!=a.unitId}).ToArray();if(c.newGroupClassInfo.startDate&&b&&0<b.length&&c.newGroupClassInfo.unitStartId){var d=0,e=[],f=[],g=Enumerable.From(b).First(function(a){return a.unitId==
c.newGroupClassInfo.unitStartId}),h=b.indexOf(g);angular.forEach(b,function(a){b.indexOf(a)>=h?e.push(a):f.push(a)});e=e.concat(f);angular.forEach(e,function(b){for(var e=moment(c.newGroupClassInfo.startDate).add(7*d,"days").format("DD-MM-YYYY"),f=0<Enumerable.From(c.listHoliday).Count(function(a){return moment(a.holidayDate).format("DD-MM-YYYY")==e});f;)d++,a.push({unitTitle:"",date:e,isHoliday:!0}),e=moment(c.newGroupClassInfo.startDate).add(7*d,"days").format("DD-MM-YYYY"),f=0<Enumerable.From(c.listHoliday).Count(function(a){return moment(a.holidayDate).format("DD-MM-YYYY")==
e});a.push({unitTitle:b.unitTitle,date:e,isHoliday:!1});d++})}c.listClassDate=a};c.getStudyDate=function(a){return c.newGroupClassInfo.startDate?moment(c.newGroupClassInfo.startDate).add(7*a,"days").format("DD-MM-YYYY"):"N/A"};c.getStudyTime=function(){return c.newGroupClassInfo.startTime?moment(c.newGroupClassInfo.startTime).format("HH:mm"):""}}])})();
(function(){angular.module("app").controller("Catalouge.List",["$scope","$state","viewModel",function(b,d,a){var g=this,h=d.params.courseId,e=d.params.unitId;g.params=d.params;g.listCourse=a.listCourse?a.listCourse:[];g.listUnit=a.listUnit?a.listUnit:[];g.listLesson=a.listLesson?a.listLesson:[];g.listActivity=a.listActivity;g.listCourse.unshift({courseId:"0",courseTitle:"All"});g.listUnit.unshift({unitId:"0",unitTitle:"All"});g.listLesson.unshift({lessonId:"0",lessonTitle:"All"});g.filterCatalouge=
function(){g.params.courseId!=h?(g.params.unitId=void 0,g.params.lessonId=void 0):g.params.unitId!=e&&(g.params.lessonId=void 0);d.go(".",g.params,{reload:!0})}}])})();
(function(){angular.module("app").controller("Course.Manage",["$scope","$state","$timeout","viewModel","courseService","notificationService","progressService","fileUploader","trainerService",function(b,d,a,g,h,e,f,c,l){var k=this;k.listCourse=g.listCourse;k.listTrainer=g.listTrainer;angular.forEach(k.listCourse,function(a){h.getUnitInCourse({courseId:a.courseId}).then(function(b){a.listUnit=b.data});a.listTrainer=Enumerable.From(a.listTrainer).Select("$.fullName").ToArray()});k.addNewCourse=function(){h.executeCourse({courseId:0,
courseTitle:"",courseDes:"",courseShortDes:"",executeType:"I"}).then(function(a){console.log(a);a&&a.data&&1==a.data.id?(e.success("Course Added"),d.reload()):e.error(a.message)})};k.saveCourseInfo=function(a,b){a.executeType="U";a.updateField=b;f.start();h.executeCourse(a).then(function(c){if(c&&c.data&&1==c.data.id)switch(e.success("Course Updated"),b){case "title":a.isEditingTitle=!1;break;case "image":a.isEditingCourseImage=!1;break;case "shortDes":a.isEditingShortDescription=!1;break;case "des":a.isEditingDescription=
!1}else e.error(c.message);f.complete()})};k.enableTitleEdit=function(b){b.isEditingTitle=!0;b.oldTitle=b.courseTitle;a(function(){angular.element(document.querySelector("#txtCourseTitle_"+b.courseId)).focus()})};k.discardTitleEdit=function(a){a.isEditingTitle=!1;a.courseTitle=a.oldTitle};k.saveTitle=function(a,b){!b||b&&(13==b.charCode||13==b.keyCode||13==b.which)?250<a.courseTitle.length?e.error("Course title too long.(Max 250 chars)"):k.saveCourseInfo(a,"title"):!b||27!=b.charCode&&27!=b.keyCode&&
27!=b.which||k.discardTitleEdit(a)};k.enableImageEdit=function(a){a.isEditingCourseImage=!0;a.oldImage=a.courseImage};k.discardImageEdit=function(a){a.isEditingCourseImage=!1;a.courseImage=a.oldImage};k.saveImage=function(a){a.fileModel?c.uploadFileToUrl(a.fileModel,"/Upload").then(function(b){b&&b.data&&1==b.data.id?(a.courseImage=b.data.location,a.fileModel=null,k.saveCourseInfo(a,"image")):e.error("Error occur when upload image")}):a.isEditingCourseImage=!1};k.enableShortDescriptionEdit=function(a){a.isEditingShortDescription=
!0;a.oldShortDescription=a.courseShortDes};k.discardShortDescriptionEdit=function(a){a.isEditingShortDescription=!1;a.courseShortDes=a.oldShortDescription};k.saveShortDescription=function(a){250<a.courseTitle.length?e.error("Short description too long.(Max 2000 chars)"):k.saveCourseInfo(a,"shortDes")};k.enableDescriptionEdit=function(a){a.isEditingDescription=!0;a.oldDescription=a.courseDes};k.discardDescriptionEdit=function(a){a.isEditingDescription=!1;a.courseDes=a.oldDescription};k.saveDescription=
function(a){k.saveCourseInfo(a,"des")};b.$on("editorSave",function(a,b){b=$(b);a=b.data("course-id");b=b.data("type");if(a=Enumerable.From(k.listCourse).FirstOrDefault(null,"$.courseId \x3d\x3d "+a))switch(b){case "shortDes":k.saveShortDescription(a);break;case "des":k.saveDescription(a)}});k.onSelectCourseTrainer=function(a,b){m(b,a,"I")};k.onRemoveCourseTrainer=function(a,b){m(b,a,"D")};var m=function(a,b,c){f.start();l.executeTrainerCourse({courseId:a.courseId,trainerId:b.userId,executeType:c}).then(function(a){a&&
1==a.data.id?e.success("Trainer added"):e.error(a.data.message);f.complete()})};k.addNewUnit=function(a){f.start();h.executeUnitCourse({courseId:a.courseId,unitTitle:"New Unit",executeType:"I"}).then(function(b){b&&0<b.data.id?(e.success("Unit added"),a.listUnit=a.listUnit?a.listUnit:[],a.listUnit.push({unitId:b.data.id,unitTitle:"New Unit"})):e.error("Error occur");f.complete()})};k.saveUnitTitle=function(a,b){!b||13!=b.charCode&&13!=b.keyCode&&13!=b.which||(250<a.unitTitle.length?e.error("Unit title too long.(Max 250 chars)"):
(f.start(),h.executeUnitCourse({unitId:a.unitId,unitTitle:a.unitTitle,executeType:"U"}).then(function(a){a&&0<a.data.id?e.success("Unit updated"):e.error("Error occur");f.complete()})))}}])})();(function(){angular.module("app").service("loginService",["$http","baseService",function(b,d){this.doLogin=function(a){return d.postData(d.baseUrl+"/doLogin",a)}}])})();
(function(){angular.module("app").service("classScheduleService",["$http","baseService",function(b,d){this.getClassSchedulePageData=function(a){return d.postData(d.baseUrl+"/class/getClassSchedulePageData",a)};this.getClassSchedule=function(a){return d.postData(d.baseUrl+"/class/getClassSchedule",a)}}])})();
(function(){angular.module("app").service("classInfoService",["$http","baseService",function(b,d){this.getClassInfoPageData=function(a){return d.postData(d.baseUrl+"/getClassInfoPageData",a)};this.updateStudentAttendance=function(a){return d.postData(d.baseUrl+"/updateStudentAttendance",a)};this.updateClassAttendanceCheck=function(a){return d.postData(d.baseUrl+"/updateClassAttendanceCheck",a)}}])})();
(function(){angular.module("app").service("studentService",["$http","baseService",function(b,d){this.getManageStudentPageData=function(a){return d.postData(d.baseUrl+"/student/getManageStudentPageData",a)};this.getAddStudentPageData=function(){return d.postData(d.baseUrl+"/student/getAddStudentPageData")};this.getIntroClassByCenterAndCourse=function(a){return d.postData(d.baseUrl+"/student/getIntroClassByCenterAndCourse",a)};this.getIncomingFirstClass=function(a){return d.postData(d.baseUrl+"/student/getIncomingFirstClass",
a)};this.getIncomingIntroClass=function(a){return d.postData(d.baseUrl+"/student/getIncomingIntroClass",a)};this.getIncomingNormalClass=function(a){return d.postData(d.baseUrl+"/student/getIncomingNormalClass",a)};this.getStudentDetailPageData=function(a){return d.postData(d.baseUrl+"/student/getStudentDetailPageData",a)};this.resetStudentPassword=function(a){return d.postData(d.baseUrl+"/student/resetStudentPassword",a)};this.getStudentClasses=function(a){return d.postData(d.baseUrl+"/student/getStudentClasses",
a)};this.retakeStudentClass=function(a){return d.postData(d.baseUrl+"/student/retakeStudentClass",a)};this.getOfflineClassForRetake=function(a){return d.postData(d.baseUrl+"/student/getOfflineClassForRetake",a)};this.getStudentDetailLogActivityData=function(a){return d.postData(d.baseUrl+"/student/getStudentDetailLogActivityData",a)};this.getAllCommentResult=function(a){return d.postData(d.baseUrl+"/student/getAllCommentResult",a)};this.addActivityLog=function(a){return d.postData(d.baseUrl+"/student/addActivityLog",
a)};this.updateStudentCourseStatus=function(a){return d.postData(d.baseUrl+"/student/updateStudentCourseStatus",a)};this.getCourseActivity=function(a){return d.postData(d.baseUrl+"/student/getCourseActivity",a)};this.getStudentProperty=function(a){return d.postData(d.baseUrl+"/student/getStudentProperty",a)};this.getStudentQuiz=function(a){return d.postData(d.baseUrl+"/student/getStudentQuiz",a)};this.getStudentOtherActivity=function(a){return d.postData(d.baseUrl+"/student/getStudentOtherActivity",
a)};this.addNewStudent=function(a){return d.postData(d.baseUrl+"/addNewStudent",a)}}])})();(function(){angular.module("app").service("userService",["$http","baseService",function(b,d){this.getManageUserPageData=function(a){return d.postData(d.baseUrl+"/user/getManageUserPageData",a)};this.addNewUser=function(a){return d.postData(d.baseUrl+"/user/addNewUser",a)}}])})();
(function(){angular.module("app").service("groupClassService",["$http","baseService",function(b,d){this.getManageGroupClassPageData=function(a){return d.postData(d.baseUrl+"/group-class/getManageGroupClassPageData",a)};this.getCourseHoliday=function(a){return d.postData(d.baseUrl+"/group-class/getCourseHoliday",a)};this.getUnitByCourseAndClassType=function(a){return d.postData(d.baseUrl+"/group-class/getUnitByCourseAndClassType",a)};this.addNewGroupClass=function(a){return d.postData(d.baseUrl+"/group-class/addNewGroupClass",
a)};this.extendGroupClass=function(a){return d.postData(d.baseUrl+"/group-class/extendGroupClass",a)}}])})();(function(){angular.module("app").service("catalougeService",["$http","baseService",function(b,d){this.getCatalougePageData=function(a){return d.postData(d.baseUrl+"/catalouge/getCatalougePageData",a)}}])})();
(function(){angular.module("app").service("courseService",["$http",function(b,d){this.baseUrl="api/course-cms";this.getData=function(a,d){return b.get(a,{params:d}).then(function(a){return a.data})};this.postData=function(a,d){return b.post(a,d).then(function(a){return a.data})};this.getListCourse=function(a){return this.postData(this.baseUrl+"/get-course-by-user-type",a)};this.getTrainerByCourseId=function(a){return this.postData(this.baseUrl+"/get-trainer-in-course",a)};this.executeCourse=function(a){return this.postData(this.baseUrl+
"/execute-course",a)};this.getUnitInCourse=function(a){return this.postData(this.baseUrl+"/cms-get-unit-in-course",a)};this.executeUnitCourse=function(a){return this.postData(this.baseUrl+"/execute-unit-course",a)}}])})();
(function(){angular.module("app").service("trainerService",["$http",function(b,d){this.baseUrl="api/course-cms";this.getData=function(a,d){return b.get(a,{params:d}).then(function(a){return a.data})};this.postData=function(a,d){return b.post(a,d).then(function(a){return a.data})};this.getAllTrainer=function(a){return this.postData(this.baseUrl+"/get-all-trainer")};this.executeTrainerCourse=function(a){return this.postData(this.baseUrl+"/execute-trainer-course",a)}}])})();